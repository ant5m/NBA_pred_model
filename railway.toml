[build]
builder = "nixpacks"

[deploy]
startCommand = "python3 build_team_stats_db.py --initial && python3 build_player_stats_db.py --initial && uvicorn api.main:app --host 0.0.0.0 --port $PORT"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Cron jobs for Railway
[[crons]]
name = "daily-predictions"
schedule = "0 10 * * *"
command = "python3 scripts/cron_predict.py"

[[crons]]
name = "update-results"
schedule = "0 3 * * *"
command = "python3 scripts/cron_update.py"

[[crons]]
name = "weekly-retrain"
schedule = "0 2 * * 0"
command = "python3 scripts/cron_retrain.py"

[[crons]]
name = "refresh-database"
schedule = "0 6 * * *"
command = "python3 scripts/cron_refresh_db.py"
